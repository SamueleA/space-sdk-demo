[{"/home/piraya/repos/space-sdk-demo/src/index.js":"1","/home/piraya/repos/space-sdk-demo/src/reportWebVitals.js":"2","/home/piraya/repos/space-sdk-demo/src/App.js":"3","/home/piraya/repos/space-sdk-demo/src/views/index.js":"4","/home/piraya/repos/space-sdk-demo/src/views/Album/index.js":"5","/home/piraya/repos/space-sdk-demo/src/views/Signin/index.js":"6","/home/piraya/repos/space-sdk-demo/src/views/Signup/index.js":"7","/home/piraya/repos/space-sdk-demo/src/shared/components/AuthForm/index.js":"8","/home/piraya/repos/space-sdk-demo/src/config.js":"9","/home/piraya/repos/space-sdk-demo/src/clients/index.js":"10","/home/piraya/repos/space-sdk-demo/src/clients/sdk.js":"11","/home/piraya/repos/space-sdk-demo/src/views/Album/components/Photo/index.js":"12","/home/piraya/repos/space-sdk-demo/src/shared/utils/typed-array-to-url.js":"13"},{"size":500,"mtime":1611954757317,"results":"14","hashOfConfig":"15"},{"size":362,"mtime":1611954757317,"results":"16","hashOfConfig":"15"},{"size":534,"mtime":1612218227034,"results":"17","hashOfConfig":"15"},{"size":135,"mtime":1612063863905,"results":"18","hashOfConfig":"15"},{"size":2372,"mtime":1612218197290,"results":"19","hashOfConfig":"15"},{"size":1023,"mtime":1612218159354,"results":"20","hashOfConfig":"15"},{"size":1344,"mtime":1612218173498,"results":"21","hashOfConfig":"15"},{"size":1383,"mtime":1612214556503,"results":"22","hashOfConfig":"15"},{"size":422,"mtime":1612203979605,"results":"23","hashOfConfig":"15"},{"size":40,"mtime":1612203797644,"results":"24","hashOfConfig":"15"},{"size":1634,"mtime":1612207709829,"results":"25","hashOfConfig":"15"},{"size":1068,"mtime":1612214631095,"results":"26","hashOfConfig":"15"},{"size":96,"mtime":1612214565755,"results":"27","hashOfConfig":"15"},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},"1vy17qz",{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"33","messages":"34","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"35","messages":"36","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"37","messages":"38","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"39","usedDeprecatedRules":"30"},{"filePath":"40","messages":"41","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"44","messages":"45","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"46","messages":"47","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"48","messages":"49","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"50","messages":"51","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"52","messages":"53","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"54","usedDeprecatedRules":"30"},{"filePath":"55","messages":"56","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"57","usedDeprecatedRules":"30"},"/home/piraya/repos/space-sdk-demo/src/index.js",[],["58","59"],"/home/piraya/repos/space-sdk-demo/src/reportWebVitals.js",[],"/home/piraya/repos/space-sdk-demo/src/App.js",[],"/home/piraya/repos/space-sdk-demo/src/views/index.js",[],"/home/piraya/repos/space-sdk-demo/src/views/Album/index.js",["60"],"import React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport { sdk } from '@clients';\nimport Photo from './components/Photo';\n\nconst Album = () => {\n  const history = useHistory();\n  const [photos, setPhotos] = useState([]);\n  const [isUploading, setIsUploading] = useState(false);\n\n  const getPhotos = async () => {\n    const storage = await sdk.getStorage();\n    const { items } = await storage.listDirectory({\n      path: '/',\n      bucket: 'personal',\n      recursive: false,\n    });\n    setPhotos(items);\n  };\n\n\n  useEffect(() => {\n    // todo change to !user.info\n    const user = localStorage.getItem('user');\n\n    if (!user) {\n      history.push('/signin');\n    }\n    getPhotos();\n  }, []);\n\n  const addItemsToStorage = async ({\n    sourcePaths,\n    targetPath,\n  }) => {\n    setIsUploading(true);\n    const storage = await sdk.getStorage();\n    window.onbeforeunload = () => false;\n    const uploadResponse = await storage.addItems({\n      bucket: 'personal',\n      files: sourcePaths.map(({ data, path, mimeType }) => ({\n        data,\n        path,\n        mimeType,\n      })),\n    });\n\n    uploadResponse.once('done', async () => {\n      window.onbeforeunload = null;\n      const { items } = await storage.listDirectory({\n        path: '/',\n        bucket: 'personal',\n        recursive: false,\n      });\n      setPhotos(items);\n      setIsUploading(false);\n    });\n  };\n\n  const addPhoto = async () => {\n    const fileInput = document.createElement('input');\n    fileInput.setAttribute('multiple', '');\n\n    fileInput.addEventListener('change', (event) => {\n      const sourcePaths = Array.from(event.target.files).map((file) => ({\n        name: file.name,\n        size: file.size,\n        data: file,\n        mimeType: file.type,\n        path: file.webkitRelativePath || file.name,\n      }));\n\n      addItemsToStorage({\n        sourcePaths,\n        targetPath: '/',\n      });\n    });\n\n    fileInput.type = 'file';\n    fileInput.click();\n  };\n\n  return (\n    <div>\n      <Button\n        onClick={addPhoto}\n        variant=\"contained\"\n        color=\"primary\"\n        disabled={isUploading}\n      >\n        Add Photo\n      </Button>\n      {photos.map((photo) => (\n        <Photo\n          name={photo.name}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default Album;\n","/home/piraya/repos/space-sdk-demo/src/views/Signin/index.js",[],"/home/piraya/repos/space-sdk-demo/src/views/Signup/index.js",[],"/home/piraya/repos/space-sdk-demo/src/shared/components/AuthForm/index.js",[],"/home/piraya/repos/space-sdk-demo/src/config.js",[],"/home/piraya/repos/space-sdk-demo/src/clients/index.js",[],"/home/piraya/repos/space-sdk-demo/src/clients/sdk.js",[],"/home/piraya/repos/space-sdk-demo/src/views/Album/components/Photo/index.js",["61"],"import React, { useState, useEffect } from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { sdk } from '@clients';\nimport typedArrayToUrl from '@utils/typed-array-to-url';\n\nconst Photo = ({\n  name,\n}) => {\n  const [loading, setLoading] = useState(true);\n  const [url, setUrl] = useState(null);\n\n  const getPhotoUrl = async () => {\n    setLoading(true);\n    try {\n      const storage = await sdk.getStorage();\n\n      const response = await storage.openFile({\n        bucket: 'personal',\n        path: `/${name}`\n      });\n      const fileBytes = await response.consumeStream();\n      const fileUrl = typedArrayToUrl([fileBytes.buffer], response.mimeType);\n      \n      setUrl(fileUrl);\n    } catch(e) {\n      console.error('Failed to fetch url', e);\n    }\n    setLoading(false);\n  };\n\n  useEffect(() => {\n    getPhotoUrl();\n  }, []);\n\n  return (\n    <div>\n      <Typography>{name}</Typography>\n      {loading ? (\n        <span>Loading...</span>\n      ) : (\n        <img src={url} alt={name} />\n      )}\n    </div>\n  );\n};\n\nexport default Photo;\n","/home/piraya/repos/space-sdk-demo/src/shared/utils/typed-array-to-url.js",["62"],"export default (buffer, mimeType) => URL.createObjectURL(new Blob(buffer, { type: mimeType }));\n",{"ruleId":"63","replacedBy":"64"},{"ruleId":"65","replacedBy":"66"},{"ruleId":"67","severity":1,"message":"68","line":31,"column":6,"nodeType":"69","endLine":31,"endColumn":8,"suggestions":"70"},{"ruleId":"67","severity":1,"message":"71","line":33,"column":6,"nodeType":"69","endLine":33,"endColumn":8,"suggestions":"72"},{"ruleId":"73","severity":1,"message":"74","line":1,"column":1,"nodeType":"75","endLine":1,"endColumn":96},"no-native-reassign",["76"],"no-negated-in-lhs",["77"],"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'history'. Either include it or remove the dependency array.","ArrayExpression",["78"],"React Hook useEffect has a missing dependency: 'getPhotoUrl'. Either include it or remove the dependency array.",["79"],"import/no-anonymous-default-export","Assign arrow function to a variable before exporting as module default","ExportDefaultDeclaration","no-global-assign","no-unsafe-negation",{"desc":"80","fix":"81"},{"desc":"82","fix":"83"},"Update the dependencies array to be: [history]",{"range":"84","text":"85"},"Update the dependencies array to be: [getPhotoUrl]",{"range":"86","text":"87"},[786,788],"[history]",[852,854],"[getPhotoUrl]"]